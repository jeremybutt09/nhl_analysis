DELETE FROM dim_team WHERE team_id IN (SELECT DISTINCT team_id FROM dim_team_load);

INSERT INTO dim_team (
    team_id,
    team_full_name,
    team_link,
    team_abbreviation,
    team_name,
    location_name,
    first_year_of_play,
    team_short_name,
    official_site_url,
    active,
    venue_name,
    venue_link,
    venue_city,
    venue_time_zone_id,
    venue_time_zone_offset,
    venue_time_zone_tz,
    division_id,
    division_name,
    division_name_short,
    division_link,
    division_abbreviation,
    conference_id,
    conference_name,
    conference_link,
    franchise_id,
    franchise_team_name,
    franchise_link,
    venue_id,
    load_date
)
SELECT
    team_id,
    team_full_name,
    team_link,
    team_abbreviation,
    team_name,
    location_name,
    first_year_of_play,
    team_short_name,
    official_site_url,
    active,
    venue_name,
    venue_link,
    venue_city,
    venue_time_zone_id,
    venue_time_zone_offset,
    venue_time_zone_tz,
    division_id,
    division_name,
    division_name_short,
    division_link,
    division_abbreviation,
    conference_id,
    conference_name,
    conference_link,
    franchise_id,
    franchise_team_name,
    franchise_link,
    venue_id,
    SYSDATE
FROM
    dim_team_load;

DELETE FROM dim_team_load;